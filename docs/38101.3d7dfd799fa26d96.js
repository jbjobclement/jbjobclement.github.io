"use strict";(self.webpackChunkJbNotifier=self.webpackChunkJbNotifier||[]).push([[38101],{38101:(At,h,a)=>{a.r(h),a.d(h,{RecurringNotificationInfosModule:()=>St});var m=a(96814),N=a(31610),g=a(88762),f=a(23758),p=a(35461),c=a(85054);const u=[{type:"buttons",fixed:!0,buttons:[{name:"schedule-plans",template:"gridSchedulePlanDetailsButton"},{name:"edit",template:"grid-edit-button",disabled:i=>!i.row?.data?.isEditable},{name:"delete",template:"grid-delete-button",disabled:i=>!i.row?.data?.isDeletable}]},{dataField:"id",visible:!1},{dataField:"concurrencyStamp",visible:!1},{dataField:"SpecifiedTenantId",caption:"\u6307\u5b9a\u79df\u6236",dataType:"string",visible:!1},{name:"tenantName",caption:"\u79df\u6236\u540d\u7a31",dataType:"string",filterOperations:p.I$.text},{name:"notificationCategoryName",caption:"\u5206\u985e\u540d\u7a31",dataType:"string",filterOperations:p.I$.text},{dataField:"name",caption:"\u901a\u77e5\u540d\u7a31",dataType:"string",filterOperations:p.I$.text,validationRules:[c.L]},{name:"notificationProviders",caption:"\u901a\u77e5\u63d0\u4f9b\u8005",dataType:"string",filterOperations:p.I$.text,calculateDisplayValue:i=>i.notificationProviders?.map(s=>s.displayName).join("\u3001"),width:160,allowFiltering:!1,allowSorting:!1},{name:"receiverDescription",caption:"\u63a5\u6536\u8005\u63cf\u8ff0",dataType:"string",filterOperations:p.I$.text,allowFiltering:!1,allowSorting:!1},{type:"detailExpand",fixed:!0,fixedPosition:"right"},{dataField:"notificationDataFetchEndpoint",caption:"\u53d6\u5f97\u901a\u77e5\u8cc7\u6599 Endpoint",dataType:"string",filterOperations:p.I$.text,visible:!1},{dataField:"hookEndpoint",caption:"Hook",dataType:"string",filterOperations:p.I$.text,visible:!1},{name:"isFullyFinished",caption:"\u662f\u5426\u5df2\u5b8c\u6210",dataType:"boolean",visible:!1},{name:"isDeletable",caption:"\u662f\u5426\u53ef\u522a\u9664",dataType:"boolean",visible:!1},{name:"isEditable",caption:"\u662f\u5426\u53ef\u7de8\u8f2f",dataType:"boolean",visible:!1},{dataField:"title",caption:"\u6a19\u984c",dataType:"string",visible:!1,validationRules:[c.L]},{dataField:"notificationProviderIds",caption:"\u901a\u77e5\u63d0\u4f9b\u8005id (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"notificationProviderIds",validationRules:[c.L]},{dataField:"isSendToAllReceivers",caption:"\u63a5\u6536\u8005",dataType:"boolean",visible:!1,editCellTemplate:"isSendToAllReceivers"},{dataField:"receiverIds",caption:"\u63a5\u6536\u8005 (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"receiverIds"},{dataField:"receiverGroupIds",caption:"\u63a5\u6536\u7fa4\u7d44 (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"receiverGroupIds"},{dataField:"topicIds",caption:"\u4e3b\u984c (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"topicIds"},{dataField:"isIndependentNotificationSettingUsing",caption:"\u901a\u77e5\u8a2d\u5b9a",dataType:"boolean",visible:!1,editCellTemplate:"isIndependentNotificationSettingUsing"},{dataField:"notificationSettings",caption:"\u901a\u77e5\u8a2d\u5b9a\u9805\u76ee",dataType:"object",visible:!1,editCellTemplate:"notificationSettings"},{dataField:"notificationSchedulePlans",caption:"\u91cd\u8907\u6642\u9593\u8a08\u756b",dataType:"object",visible:!1,editCellTemplate:"recurringNotificationSchedulePlans"},{dataField:"notificationCategoryId",caption:"\u901a\u77e5\u5206\u985e Id",dataType:"string",visible:!1,validationRules:[c.L]},{dataField:"subtitle",caption:"\u5b50\u6a19\u984c",dataType:"string",visible:!1,validationRules:[c.L]},{dataField:"textContent",caption:"\u6587\u5b57\u5167\u5bb9",dataType:"string",visible:!1},{dataField:"htmlContent",caption:"Html \u5167\u5bb9",dataType:"string",visible:!1},{dataField:"isFetchNotificationDataByEachReceiver",caption:"\u662f\u5426\u4f9d\u5404\u901a\u77e5\u63a5\u6536\u8005\u53d6\u5f97\u8cc7\u6599",dataType:"string",visible:!1},{dataField:"filePaths",dataType:"string",visible:!1},{dataField:"hyperlink",dataType:"string",visible:!1},{dataField:"isUsingTemplate",caption:"\u6a21\u677f",dataType:"boolean",visible:!1,editCellTemplate:"isUsingTemplate"},{dataField:"textContentNotificationTemplateId",caption:"\u901a\u77e5\u6a21\u677fId",dataType:"string",visible:!1},{name:"textContentNotificationTemplateName",caption:"\u901a\u77e5\u6a21\u677f\u540d\u7a31",dataType:"string",visible:!1},{dataField:"textContentNotificationTemplateArgs",caption:"text content \u901a\u77e5\u6a21\u677f\u53c3\u6578",dataType:"string",visible:!1,editCellTemplate:"textContentNotificationTemplateArgs"}],T={index:"/api/app/recurring-notifications",get:"/api/app/recurring-notifications",create:"/api/app/recurring-notifications",update:"/api/app/recurring-notifications",delete:"/api/app/recurring-notifications"},D=[{dataField:"notificationProviderIds",path:"/api/app/recurring-notifications/notification-provider-lookup"},{dataField:"receiverIds",path:"/api/app/recurring-notifications/receiver-lookup"},{dataField:"receiverGroupIds",path:"/api/app/notification-infos/receiver-group-treeview"},{dataField:"topicIds",path:"/api/app/recurring-notifications/topic-lookup"},{dataField:"textContentNotificationTemplateId",path:"/api/app/recurring-notifications/notification-template-lookup"},{dataField:"notificationCategoryId",path:"/api/app/recurring-notifications/notification-category-lookup"},{dataField:"SpecifiedTenantId",path:"/api/app/recurring-notifications/tenant-lookup",pathForSelectedDisplay:"/api/app/jbnotifier-admin/customized-tenants"}],x=[{dataField:"id",mapping:["notificationInfo","id"]},{dataField:"concurrencyStamp",mapping:["notificationInfo","concurrencyStamp"]},{name:"type",mapping:["notificationInfo","type"]},{dataField:"name",queryStringKey:"Name",mapping:["notificationInfo","name"]},{name:"tenantName",queryStringKey:"TenantName",mapping:["tenant","name"]},{name:"notificationCategoryName",queryStringKey:"NotificationCategoryName",mapping:["notificationCategory","name"]},{name:"notificationProviders",queryStringKey:"NotificationProviderNames",mapping:["notificationProviders"]},{name:"receiverDescription",queryStringKey:"ReceiverDescription",mapping:["receiverDescription"]},{dataField:"notificationDataFetchEndpoint",queryStringKey:"NotificationDataFetchEndpoint",mapping:["notificationInfo","notificationDataFetchEndpoint"]},{dataField:"hookEndpoint",queryStringKey:"HookEndpoint",mapping:["notificationInfo","hookEndpoint"]},{name:"isFullyFinished",queryStringKey:"IsFullyFinished",mapping:["notificationInfo","isFullyFinished"]},{name:"isDeletable",queryStringKey:"IsDeletable",mapping:["isDeletable"]},{name:"isEditable",queryStringKey:"IsEditable",mapping:["isEditable"]},{dataField:"title",queryStringKey:"Title",mapping:["notificationInfo","title"]},{dataField:"notificationProviderIds",mapping:["notificationProviderIds"]},{dataField:"isSendToAllReceivers",mapping:["notificationInfo","isSendToAllReceivers"]},{dataField:"receiverIds",mapping:["receiverIds"]},{dataField:"receiverGroupIds",mapping:["receiverGroupIds"]},{dataField:"topicIds",mapping:["topicIds"]},{dataField:"isIndependentNotificationSettingUsing",mapping:["notificationInfo","isIndependentNotificationSettingUsing"]},{dataField:"notificationSettings",mapping:["notificationSettings"]},{dataField:"notificationSchedulePlans",mapping:["notificationSchedulePlans"]},{dataField:"notificationCategoryId",mapping:["notificationCategory","id"]},{dataField:"subtitle",mapping:["notificationInfo","subtitle"]},{dataField:"textContent",mapping:["notificationInfo","textContent"]},{dataField:"htmlContent",mapping:["notificationInfo","htmlContent"]},{dataField:"isFetchNotificationDataByEachReceiver",mapping:["notificationInfo","isFetchNotificationDataByEachReceiver"]},{dataField:"filePaths",mapping:["notificationInfo","filePaths"]},{dataField:"hyperlink",mapping:["notificationInfo","hyperlink"]},{dataField:"textContentNotificationTemplateId",mapping:["textContentNotificationTemplate","id"]},{name:"textContentNotificationTemplateName",mapping:["textContentNotificationTemplate","name"]},{dataField:"textContentNotificationTemplateArgs",mapping:["notificationInfo","textContentNotificationTemplateArgs"]},{dataField:"receivers",mapping:["receivers"]},{dataField:"receiverGroups",mapping:["receiverGroups"]},{dataField:"topics",mapping:["topics"]},{dataField:"SpecifiedTenantId",mapping:["tenant","id"]}],v=[{itemType:"group",name:"TopGroup",cssClass:"TopGroup",colCount:8,items:[{itemType:"group",name:"BasicGroup",cssClass:"BasicGroup",caption:"\u57fa\u672c",colSpan:5,items:[{dataField:"SpecifiedTenantId",editorType:"dxSelectBox",visible:!1},{dataField:"name",editorType:"dxTextBox",label:{text:"\u901a\u77e5\u540d\u7a31"}},{dataField:"notificationProviderIds",label:{visible:!1}},{dataField:"isSendToAllReceivers",cssClass:"isSendToAllReceivers"},{itemType:"group",name:"custom-validation-group",cssClass:"custom-validation-group recurring-notification-custom-validation-group",items:[{itemType:"group",name:"custom-validation-group-inputs",cssClass:"custom-validation-group-inputs",items:[{dataField:"receiverIds",label:{visible:!1}},{dataField:"receiverGroupIds",label:{visible:!1}},{dataField:"topicIds",label:{visible:!1}}]},{name:"error",cssClass:"custom-validation-group-error-message",template:"error"}]}]},{itemType:"group",name:"SettingGroup",cssClass:"SettingGroup",caption:"\u8a2d\u5b9a",colSpan:3,items:[{dataField:"isIndependentNotificationSettingUsing"},{dataField:"notificationSettings",label:{visible:!1}}]}]},{itemType:"group",name:"SchedulePlanGroup",cssClass:"SchedulePlanGroup",caption:"\u91cd\u8907\u6642\u9593\u8a08\u5283",items:[{dataField:"notificationSchedulePlans",label:{visible:!1}}]},{itemType:"group",name:"NotificationContentGroup",cssClass:"NotificationContentGroup",caption:"\u901a\u77e5\u5167\u5bb9",colCount:2,items:[{dataField:"isUsingTemplate",cssClass:"isUsingTemplate",label:{visible:!1}},{itemType:"empty"},{dataField:"notificationCategoryId",editorType:"dxSelectBox"},{itemType:"empty"},{dataField:"title",editorType:"dxTextBox"},{dataField:"subtitle",editorType:"dxTextBox"},{itemType:"group",name:"CustomContentGroup",cssClass:"CustomContentGroup",colSpan:2,colCount:8,items:[{dataField:"textContent",editorType:"dxTextArea",editorOptions:{height:"240px"},colSpan:3},{dataField:"htmlContent",editorType:"dxHtmlEditor",editorOptions:{...a(35130).W,height:"240px"},colSpan:5}]},{itemType:"group",name:"NotificationTemplateGroup",cssClass:"NotificationTemplateGroup NotificationTemplateGroup--inactive",colSpan:2,colCount:2,items:[{dataField:"textContentNotificationTemplateId",editorType:"dxSelectBox",cssClass:"textContentNotificationTemplateId"},{itemType:"empty"},{dataField:"textContentNotificationTemplateArgs",label:{visible:!1},colSpan:2}]},{itemType:"group",name:"EndpointGroup",cssClass:"EndpointGroup",colSpan:2,colCount:3,items:[{dataField:"notificationDataFetchEndpoint",editorType:"dxTextBox"},{dataField:"hookEndpoint",editorType:"dxTextBox"},{dataField:"isFetchNotificationDataByEachReceiver",editorType:"dxCheckBox",cssClass:"basic-form-checkbox"}]}]}],R={popup:{title:"::\u7de8\u8f2f",wrapperAttr:{class:"basic-popup"},showCloseButton:!0,toolbarItems:[{toolbar:"bottom",template:"bottom-toolbar"}],width:"85vw",height:"90vh"},form:{colCount:1,items:v,elementAttr:{class:"custom-form custom-form--edit custom-form--edit-notification"}}},A={popup:{title:"JbNotifier::Permission:Notifications",wrapperAttr:{class:"basic-popup"},showCloseButton:!0,toolbarItems:[{toolbar:"bottom",template:"bottom-toolbar"}],width:"85vw",height:"90vh"},form:{colCount:1,items:v,elementAttr:{class:"custom-form custom-form--edit custom-form--edit-notification"}}};var t=a(19212),E=a(53009),G=a(67),O=a(72783),M=a(82310),Q=a(59444),V=a(69420),w=a(67846),y=a(13443),B=a(65343),J=a(92931),K=a(35098),C=a(16358),F=a(20843),b=a(25012),I=a(34906),Z=a(21194);const k=[{dataField:"name",caption:"\u8a08\u756b\u540d\u7a31",dataType:"string"},{dataField:"cronDescription",caption:"Cron \u63cf\u8ff0",dataType:"string"},{dataField:"pushCount",caption:"\u5df2\u63a8\u9001\u6b21\u6578",dataType:"number",alignment:"left"},{dataField:"nextExpectedParseTime",caption:"\u4e0b\u6b21\u89e3\u6790\u6642\u9593",dataType:"string"},{dataField:"nextExpectedPushTime",caption:"\u4e0b\u6b21\u63a8\u9001\u6642\u9593",dataType:"string"},{dataField:"isActive",caption:"\u662f\u5426\u5df2\u555f\u7528",dataType:"boolean"},{dataField:"isFullyFinished",caption:"\u662f\u5426\u5df2\u5b8c\u6210",dataType:"boolean"}],U=[],$=[{dataField:"name",mapping:["name"]},{dataField:"cronDescription",mapping:["cronDescription"]},{dataField:"pushCount",mapping:["pushCount"]},{dataField:"nextExpectedParseTime",mapping:["nextExpectedParseTime"]},{dataField:"nextExpectedPushTime",mapping:["nextExpectedPushTime"]},{dataField:"isActive",mapping:["isActive"]},{dataField:"isFullyFinished",mapping:["isFullyFinished"]}];var S=a(93116),L=a(27310),Y=a(98179);const j=["grid"];function H(i,s){if(1&i&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&i){const e=s.$implicit;t.xp6(),t.hij(" ",e.column.caption," ")}}function z(i,s){if(1&i&&(t.TgZ(0,"div")(1,"dx-data-grid",2,3),t.YNc(3,H,2,1,"div",1),t.qZA()()),2&i){const e=t.oxw();t.xp6(),t.Q6J("datafieldValueQueryStringKeyMapping",e.relatedDataValueAndQueryStringKeyMapping)("dataFieldLookUpSourceMapping",e.dataFieldLookupSourceMapping)("columns",e.columns)("dataSource",e.gridDataSource)("gridProperties",e.gridProperties),t.xp6(2),t.Q6J("dxTemplateOf","JBHeaderCellTemplate")}}const W=()=>({class:"custom-button"});function X(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"dx-button",4),t.NdJ("onClick",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.closePopup())}),t.qZA()()}2&i&&(t.xp6(),t.Q6J("elementAttr",t.DdM(1,W)))}const q=()=>({toolbar:"bottom",template:"bottom-toolbar"}),tt=i=>[i],it=()=>({class:"basic-popup"});let et=(()=>{class i{constructor(){this.isDetailsVisible=!1,this.isDetailsVisibleChange=new t.vpe,this.columns=k,this.dataFieldLookupSourceMapping=U,this.relatedDataValueAndQueryStringKeyMapping=$,this.gridProperties={editing:{allowDeleting:!1,allowUpdating:!1},filterRow:{visible:!1},toolbar:{visible:!1},pager:{visible:!1},height:"85%",elementAttr:{class:"schedule-plan-data-grid"}},this.gridDataSource=[]}ngOnChanges(){this.getDataSource()}getDataSource(){this.notificationSchedulePlans?.length&&(this.gridDataSource=this.notificationSchedulePlans.map(e=>({cronDescription:e.cronDescription,name:e.name,pushCount:e.pushCount,nextExpectedParseTime:(0,S.mr)(e.nextExpectedParseTime),nextExpectedPushTime:(0,S.mr)(e.nextExpectedPushTime),isActive:e.isActive,isFullyFinished:e.isFullyFinished})))}closePopup(){this.isDetailsVisibleChange.emit(!1)}static#t=this.\u0275fac=function(o){return new(o||i)};static#i=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-notification-schedule-plan-details"]],viewQuery:function(o,n){if(1&o&&t.Gf(j,5),2&o){let l;t.iGM(l=t.CRH())&&(n.grid=l.first)}},inputs:{notificationSchedulePlans:"notificationSchedulePlans",isDetailsVisible:"isDetailsVisible"},outputs:{isDetailsVisibleChange:"isDetailsVisibleChange"},features:[t.TTD],decls:3,vars:9,consts:[["title","\u6642\u9593\u8a08\u756b\u7d30\u7bc0","width","85vw","height","90vh",3,"visible","toolbarItems","wrapperAttr","visibleChange"],[4,"dxTemplate","dxTemplateOf"],["appGridFeature","",3,"datafieldValueQueryStringKeyMapping","dataFieldLookUpSourceMapping","columns","dataSource","gridProperties"],["grid",""],["appCustomButton","","text","\u95dc\u9589",3,"elementAttr","onClick"]],template:function(o,n){1&o&&(t.TgZ(0,"dx-popup",0),t.NdJ("visibleChange",function(r){return n.isDetailsVisible=r}),t.YNc(1,z,4,6,"div",1)(2,X,2,2,"div",1),t.qZA()),2&o&&(t.Q6J("visible",n.isDetailsVisible)("toolbarItems",t.VKq(6,tt,t.DdM(5,q)))("wrapperAttr",t.DdM(8,it)),t.xp6(),t.Q6J("dxTemplateOf","content"),t.xp6(),t.Q6J("dxTemplateOf","bottom-toolbar"))},dependencies:[y._,L.A,C.K,F.p6,Y.x,b.e],encapsulation:2})}return i})();const nt=["grid"];function at(i,s){if(1&i&&(t.ynx(0),t.TgZ(1,"div"),t._uU(2),t.qZA(),t.BQk()),2&i){const e=t.oxw();t.xp6(2),t.hij(" ",e.errorMessage," ")}}function ot(i,s){if(1&i&&(t.TgZ(0,"div"),t._UZ(1,"app-bottom-toolbar-btns",2),t.qZA()),2&i){t.oxw();const e=t.MAs(10);t.xp6(),t.Q6J("grid",e)}}function lt(i,s){1&i&&t.GkF(0)}const _=i=>({$implicit:i});function st(i,s){if(1&i&&(t.ynx(0),t.YNc(1,lt,1,0,"ng-container",10),t.BQk()),2&i){const e=s.$implicit,o=t.oxw().$implicit,n=t.oxw();t.xp6(),t.Q6J("ngTemplateOutlet",n.templateStore.getGridTemplates(o.key))("ngTemplateOutletContext",t.VKq(2,_,e))}}function rt(i,s){if(1&i&&(t.ynx(0),t.YNc(1,st,2,4,"ng-container",7),t.BQk()),2&i){const e=s.$implicit;t.xp6(),t.Q6J("dxTemplateOf",e.key)}}function dt(i,s){1&i&&t.GkF(0)}const pt=(i,s,e)=>({$implicit:i,templateKey:s,notificationTemplateId:e});function ct(i,s){if(1&i&&t.YNc(0,dt,1,0,"ng-container",10),2&i){const e=t.oxw().$implicit,o=t.oxw().$implicit,n=t.oxw();t.Q6J("ngTemplateOutlet",n.notificationTemplateStore.getTemplates(o.key))("ngTemplateOutletContext",t.kEZ(2,pt,e,o.key,n.notificationTemplateId))}}function mt(i,s){1&i&&t.GkF(0)}const ut=(i,s)=>({$implicit:i,templateKey:s});function gt(i,s){if(1&i&&t.YNc(0,mt,1,0,"ng-container",10),2&i){const e=t.oxw().$implicit,o=t.oxw().$implicit,n=t.oxw();t.Q6J("ngTemplateOutlet",n.notificationTemplateStore.getTemplates(o.key))("ngTemplateOutletContext",t.WLB(2,ut,e,o.key))}}function ft(i,s){if(1&i&&(t.ynx(0),t.YNc(1,ct,1,6,"ng-container")(2,gt,1,5),t.BQk()),2&i){const e=t.oxw().$implicit;t.xp6(),t.um2(1,"textContentNotificationTemplateArgs"===e.key?1:2)}}function vt(i,s){if(1&i&&(t.ynx(0),t.YNc(1,ft,3,1,"ng-container",7),t.BQk()),2&i){const e=s.$implicit;t.xp6(),t.Q6J("dxTemplateOf",e.key)}}function ht(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"dx-button",12),t.NdJ("click",function(){const l=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.openDetailsTable(l.data.id))}),t.qZA()}}function Tt(i,s){1&i&&t.GkF(0)}const xt=[{path:"",component:(()=>{class i{constructor(e,o,n,l,r,_t,Nt){this.appRestService=e,this.gridDataSourceService=o,this.templateStore=n,this.notificationTemplateStore=l,this.router=r,this.tenantChooser=_t,this.configStateService=Nt,this.columns=u,this.cRUDEndpoints=T,this.dataFieldLookupSourceMapping=D,this.relatedDataValueAndQueryStringKeyMapping=x,this.editingPropertiesForCreating=R,this.editingPropertiesForUpdating=A,this.isDetailsVisible=!1,this.errorMessage="",this.gridProperties={masterDetail:{enabled:!0,template:"basic-master-detail-row-template"},height:"85%"},this.configStateService.getOne$("currentUser").subscribe(d=>{d.tenantId&&(this.columns[4].visible=!1)}),this.tenantChooser.tenantId$.subscribe(d=>{this.grid?.instance?.refresh()});const Dt=u.find(d=>"receiverGroupIds"===d.dataField),Pt=u.find(d=>"topicIds"===d.dataField),Rt=u.find(d=>"receiverIds"===d.dataField);Dt.validationRules=[this.setCustomValidationRule("receiverGroupIds")],Pt.validationRules=[this.setCustomValidationRule("topicIds")],Rt.validationRules=[this.setCustomValidationRule("receiverIds")]}setCustomValidationRule(e){const o=["receiverIds","receiverGroupIds","topicIds"].filter(l=>l!==e);return{type:"custom",message:"\u63a5\u6536\u8005\u3001\u63a5\u6536\u8005\u7fa4\u7d44\u3001\u4e3b\u984c\u5fc5\u9808\u9078\u64c7\u4e00\u9805",reevaluate:!0,validationCallback:l=>l.data.isSendToAllReceivers||l.value.length||l.data[o[0]].length||l.data[o[1]].length?(document.querySelector(".recurring-notification-custom-validation-group").classList.remove("error"),this.errorMessage="",!0):(document.querySelector(".recurring-notification-custom-validation-group").classList.add("error"),this.errorMessage="\u63a5\u6536\u8005\u3001\u63a5\u6536\u8005\u7fa4\u7d44\u3001\u4e3b\u984c\u5fc5\u9808\u9078\u64c7\u4e00\u9805",!1)}}ngOnInit(){this.gridDataSource=this.gridDataSourceService.getDataSource(T,x)}onRowExpanded(e){this.applyNotificationMasterDetailRowCollapse(e)}applyNotificationMasterDetailRowCollapse(e){setTimeout(()=>{const n=e.element.querySelector('[aria-label="Collapse"]').parentElement.ariaRowIndex;e.element.querySelector(`tr.dx-row.dx-data-row.dx-row-lines[aria-rowindex="${n}"]`).classList.add("master-detail-row-collapse")}),e.key!==this.masterDetailRowCollapseKey&&(e.component.collapseRow(this.masterDetailRowCollapseKey),this.masterDetailRowCollapseKey=e.key)}openDetailsTable(e){this.appRestService.request({method:"GET",url:`/api/app/recurring-notifications/${e}`}).subscribe(o=>{this.notificationSchedulePlans=o.notificationSchedulePlans,this.isDetailsVisible=!0})}onSaving(e){"update"===e.changes[0]?.type&&e.changes[0].data.isSendToAllReceivers&&(e.changes[0].data.receiverIds=[],e.changes[0].data.receiverGroupIds=[],e.changes[0].data.topicIds=[]),"update"===e.changes[0]?.type&&e.changes[0].data?.textContentNotificationTemplateId&&(e.changes[0].data.htmlContentNotificationTemplateId=e.changes[0].data?.textContentNotificationTemplateId,e.changes[0].data.htmlContentNotificationTemplateArgs=e.changes[0].data?.textContentNotificationTemplateArgs||"")}onOptionChanged(e){"editing.changes"!==e.fullName||!e.value||!e.value[0]?.data||!("textContentNotificationTemplateId"in e.value[0].data)||(this.notificationTemplateId=e.value[0].data.textContentNotificationTemplateId)}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(E.$),t.Y36(G.I),t.Y36(O.z),t.Y36(M.P),t.Y36(f.F0),t.Y36(Q.L),t.Y36(g.XJE))};static#i=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-recurring-notification-infos"]],viewQuery:function(o,n){if(1&o&&t.Gf(nt,5),2&o){let l;t.iGM(l=t.CRH())&&(n.grid=l.first)}},decls:20,vars:26,consts:[[1,"custom-grid-container"],[1,"grid-tool-bar"],[3,"grid"],[1,"d-flex","justify-content-between"],["appGridAddButton","",3,"onClick"],["appGridFeature","","appGridFeatureNotification","",3,"datafieldValueQueryStringKeyMapping","dataFieldLookUpSourceMapping","editingPropertiesForCreating","editingPropertiesForUpdating","columns","dataSource","isEditingDataAsync","gridProperties","notificationTemplateId","notificationTemplateIdChange","onRowExpanded","onOptionChanged","onSaving"],["grid",""],[4,"dxTemplate","dxTemplateOf"],[4,"ngFor","ngForOf"],["appGridViewButton","",3,"click",4,"dxTemplate","dxTemplateOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"isDetailsVisible","notificationSchedulePlans","isDetailsVisibleChange"],["appGridViewButton","",3,"click"]],template:function(o,n){if(1&o&&(t.TgZ(0,"div",0),t._UZ(1,"app-tenant-chooser"),t.TgZ(2,"div",1)(3,"div"),t._UZ(4,"app-grid-filter-items",2),t.qZA(),t.TgZ(5,"div",3)(6,"div")(7,"dx-button",4),t.NdJ("onClick",function(){return n.router.navigate(["./recurring-notification-infos/create-notification-info"])}),t.qZA()(),t._UZ(8,"app-grid-after-tool-bar",2),t.qZA()(),t.TgZ(9,"dx-data-grid",5,6),t.NdJ("notificationTemplateIdChange",function(r){return n.notificationTemplateId=r})("onRowExpanded",function(r){return n.onRowExpanded(r)})("onOptionChanged",function(r){return n.onOptionChanged(r)})("onSaving",function(r){return n.onSaving(r)}),t.YNc(11,at,3,1,"ng-container",7)(12,ot,2,1,"div",7)(13,rt,2,1,"ng-container",8),t.ALo(14,"keyvalue"),t.YNc(15,vt,2,1,"ng-container",8),t.ALo(16,"keyvalue"),t.YNc(17,ht,1,0,"dx-button",9),t.qZA(),t.YNc(18,Tt,1,0,"ng-container",10),t.qZA(),t.TgZ(19,"app-notification-schedule-plan-details",11),t.NdJ("isDetailsVisibleChange",function(r){return n.isDetailsVisible=r}),t.qZA()),2&o){const l=t.MAs(10);t.xp6(4),t.Q6J("grid",l),t.xp6(4),t.Q6J("grid",l),t.xp6(),t.Q6J("datafieldValueQueryStringKeyMapping",n.relatedDataValueAndQueryStringKeyMapping)("dataFieldLookUpSourceMapping",n.dataFieldLookupSourceMapping)("editingPropertiesForCreating",n.editingPropertiesForCreating)("editingPropertiesForUpdating",n.editingPropertiesForUpdating)("columns",n.columns)("dataSource",n.gridDataSource)("isEditingDataAsync",!0)("gridProperties",n.gridProperties)("notificationTemplateId",n.notificationTemplateId),t.xp6(2),t.Q6J("dxTemplateOf","error"),t.xp6(),t.Q6J("dxTemplateOf","bottom-toolbar"),t.xp6(),t.Q6J("ngForOf",t.lcZ(14,20,n.templateStore.gridTemplates)),t.xp6(2),t.Q6J("ngForOf",t.lcZ(16,22,n.notificationTemplateStore.templates)),t.xp6(2),t.Q6J("dxTemplateOf","gridSchedulePlanDetailsButton"),t.xp6(),t.Q6J("ngTemplateOutlet",n.notificationTemplateStore.getTemplates("notificationPager"))("ngTemplateOutletContext",t.VKq(24,_,l)),t.xp6(),t.Q6J("isDetailsVisible",n.isDetailsVisible)("notificationSchedulePlans",n.notificationSchedulePlans)}},dependencies:[m.sg,m.tP,V.p,w.S,y._,B.f,J.R,K.V,C.K,F.p6,b.e,I.W,Z.D,et,m.Nd],styles:[".grid-tool-bar[_ngcontent-%COMP%]{padding:0 8px}  .custom-validation-group app-notification-tree-view .dx-overlay-content.dx-invalid-message-content{display:none}  .custom-validation-group app-notification-tree-view .dx-invalid.dx-texteditor.dx-show-invalid-badge .dx-texteditor-input-container:after{display:none}  .custom-validation-group app-notification-tag-box .dx-overlay-content.dx-invalid-message-content{display:none}  .custom-validation-group app-notification-tag-box .dx-invalid.dx-texteditor.dx-show-invalid-badge .dx-texteditor-input-container:after{display:none}  .custom-validation-group{border-radius:8px}  .custom-validation-group.error{border:1px solid red;padding:8px!important}  .custom-validation-group-error-message{border-top:1px solid red!important;display:none;color:red}  .custom-validation-group.error .custom-validation-group-error-message{padding-top:8px!important;display:block}"]})}return i})(),canActivate:[g.a1M,g.nG9]},{path:"create-notification-info",loadChildren:()=>Promise.all([a.e(68592),a.e(78488)]).then(a.bind(a,78488)).then(i=>i.CreateNotificationInfoModule)}];let yt=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#i=this.\u0275mod=t.oAB({type:i});static#e=this.\u0275inj=t.cJS({imports:[f.Bz.forChild(xt),f.Bz]})}return i})();var Ct=a(5533),Ft=a(68862),bt=a(60752),It=a(41992);let St=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#i=this.\u0275mod=t.oAB({type:i});static#e=this.\u0275inj=t.cJS({imports:[m.ez,yt,N.m,Ct.P,Ft.O,bt.j,I.W,It.e]})}return i})()}}]);